<fieldset class="form-section">
  @if (label()) {
    <legend class="form-label">{{ label() }}</legend>
  }

  <div class="space-y-3">
    <!-- Structured Fields Section -->
    @if (showMinSteps() || showMaxSteps() || showCfgScale() || showSamplers() || showSchedulers()) {
      <div class="space-y-3">
        <div class="requirements-section-header">Common Requirements</div>

        <!-- All numeric fields in a single row -->
        <div class="grid grid-cols-6 gap-3">
          <!-- Steps -->
          @if (showMinSteps()) {
            <div class="form-field">
              <label class="form-label text-xs" for="min-steps">Min Steps</label>
              <input
                id="min-steps"
                type="number"
                class="form-input text-sm"
                [value]="minSteps() ?? ''"
                (blur)="updateMinSteps($any($event.target).value)"
                placeholder="e.g., 3"
                min="0"
              />
            </div>
          }

          @if (showMaxSteps()) {
            <div class="form-field">
              <label class="form-label text-xs" for="max-steps">Max Steps</label>
              <input
                id="max-steps"
                type="number"
                class="form-input text-sm"
                [value]="maxSteps() ?? ''"
                (blur)="updateMaxSteps($any($event.target).value)"
                placeholder="e.g., 150"
                min="0"
              />
            </div>
          }

          <!-- CFG Scale (single value) -->
          @if (showCfgScale()) {
            <div class="form-field">
              <label class="form-label text-xs" for="cfg-scale">CFG Scale</label>
              <input
                id="cfg-scale"
                type="number"
                class="form-input text-sm"
                [value]="cfgScale() ?? ''"
                (blur)="updateCfgScale($any($event.target).value)"
                placeholder="e.g., 7.5"
                step="0.1"
                min="0"
              />
            </div>
          }

          <!-- CFG Scale Range -->
          <div class="form-field">
            <label class="form-label text-xs" for="min-cfg-scale">Min CFG</label>
            <input
              id="min-cfg-scale"
              type="number"
              class="form-input text-sm"
              [value]="minCfgScale() ?? ''"
              (blur)="updateMinCfgScale($any($event.target).value)"
              placeholder="e.g., 1.0"
              step="0.1"
              min="0"
            />
          </div>

          <div class="form-field">
            <label class="form-label text-xs" for="max-cfg-scale">Max CFG</label>
            <input
              id="max-cfg-scale"
              type="number"
              class="form-input text-sm"
              [value]="maxCfgScale() ?? ''"
              (blur)="updateMaxCfgScale($any($event.target).value)"
              placeholder="e.g., 15.0"
              step="0.1"
              min="0"
            />
          </div>

          <div class="form-field">
            <label class="form-label text-xs" for="clip-skip">CLIP Skip</label>
            <input
              id="clip-skip"
              type="number"
              class="form-input text-sm"
              [value]="clipSkip() ?? ''"
              (blur)="updateClipSkip($any($event.target).value)"
              placeholder="e.g., 2"
              min="1"
              max="12"
            />
          </div>
        </div>

        <!-- Samplers and Schedulers side by side -->
        <div class="form-grid-2">
          @if (showSamplers()) {
            <app-tag-input
              [label]="'Samplers'"
              [values]="samplers()"
              [suggestions]="knownSamplers"
              [placeholder]="'Add sampler...'"
              (valuesChange)="updateSamplers($event)"
            />
          }

          @if (showSchedulers()) {
            <app-tag-input
              [label]="'Schedulers'"
              [values]="schedulers()"
              [suggestions]="knownSchedulers"
              [placeholder]="'Add scheduler...'"
              (valuesChange)="updateSchedulers($event)"
            />
          }
        </div>
      </div>
    }

    <!-- Custom Fields Section -->
    <div>
      @if (
        showMinSteps() || showMaxSteps() || showCfgScale() || showSamplers() || showSchedulers()
      ) {
        <div class="requirements-section-header mb-3">
          Custom Requirements
          <span class="label-hint"> (Optional - for advanced or uncommon requirements) </span>
        </div>
      }

      <app-key-value-editor
        [label]="''"
        [values]="customFields()"
        (valuesChange)="updateCustomFields($event)"
      />
    </div>
  </div>
</fieldset>
