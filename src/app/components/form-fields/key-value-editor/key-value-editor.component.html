<fieldset class="form-section">
  @if (label()) {
    <legend class="form-label">{{ label() }}</legend>
  }

  @if (pairs().length > 0) {
    <div class="space-y-2">
      @for (pair of pairs(); track pair.key) {
        <div class="inline-item-row">
          <input
            type="text"
            class="form-input w-1/3"
            [value]="pair.key"
            readonly
            placeholder="Key"
          />
          <input
            type="text"
            class="form-input flex-1"
            [value]="getValueAsString(pair.value)"
            (blur)="updatePair(pair.key, pair.key, $any($event.target).value, pair.valueType)"
            placeholder="Value"
          />
          <span class="badge badge-secondary">{{ pair.valueType }}</span>
          <button
            type="button"
            class="btn btn-sm btn-danger"
            (click)="removePair(pair.key)"
            title="Remove"
          >
            Ã—
          </button>
        </div>
      }
    </div>
  }

  <div class="inline-item-row items-end">
    <div class="flex-1">
      <input
        type="text"
        class="form-input"
        placeholder="Key"
        [(ngModel)]="newKey"
        (ngModelChange)="newKey.set($event)"
      />
    </div>
    <div class="flex-1">
      <input
        type="text"
        class="form-input"
        placeholder="Value"
        [(ngModel)]="newValue"
        (ngModelChange)="newValue.set($event)"
      />
    </div>
    <select
      class="form-select"
      [(ngModel)]="newValueType"
      (ngModelChange)="newValueType.set($event)"
    >
      <option value="string">String</option>
      <option value="number">Number</option>
      <option value="boolean">Boolean</option>
      <option value="array">Array (JSON)</option>
    </select>
    <button
      type="button"
      class="btn btn-sm btn-primary"
      (click)="addPair()"
      [disabled]="!newKey().trim() || !newValue().trim()"
    >
      Add
    </button>
  </div>
</fieldset>
